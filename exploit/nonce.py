from bs4 import BeautifulSoup


class Nonce(object):
    def __init__(self, connection, hostname):
        self.connection = connection
        self.hostname = hostname

    def get_nonce(self, exploit, headers):
        nonce = None
        if exploit.nonce_url:
            response = self.connection.request(
                hostname=self.hostname + exploit.nonce_url,
                data='',
                headers=headers
            )
            soup = BeautifulSoup(response)
            try:
                nonce = soup.find('input', {'id': '_wpnonce'}).get('value')
            except:
                pass

        return nonce
